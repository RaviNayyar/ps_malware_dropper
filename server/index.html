<!DOCTYPE html>
<html>
<style>
    .float-container {
    border: 3px solid #fff;
    padding: 20px;
    }

    .float-child {
    width: 50%;
    float: left;
    padding: 20px;
    border: 2px solid black;
    }  

    .center {
        border: 5px solid;
        text-align: center;
    }
</style>

<body>

<h1>Exec R_SH</h1>

<div id="rsh_area">
    <div id="selection_area" class="float-child">
        <label for="uuid">Select a target computer:</label>
        <select name="uuid" id="uuid">
        <option value="ravin-DESKTOP-OAE00US" selected>ravin-DESKTOP-OAE00US-other</option>
        <option value="Computer 2" disabled>Computer_2</option>
        <option value="Computer 3" disabled>Computer_3</option>
        <option value="Computer_4" disabled>Computer_4</option>
        </select> <br><br>
        <label for="exec_cmd_lbl">Enter Execute Command:</label>
        <input type="text" id="exec_cmd_txtbx"><br><br>
        <input type="submit" id="submit_presed">
    </div>

    <div id="output_area" class="float-child">
        <textarea id="w3review" name="w3review" rows="10" cols="50"></textarea>
    </div>
</div>
</body>
<script>
    var cmd_json = ""

    document.getElementById("submit_presed").addEventListener("click", function() {	
        console.log("Button Pressed")
        submit_presed();
    });

    function submit_presed() {
        var exec_cmd_textbox = document.getElementById("exec_cmd_txtbx")
        var exec_cmd = exec_cmd_textbox.value
        console.log(exec_cmd)
        cmd_json = create_post_response_msg(exec_cmd)

    }

    function create_post_response_msg(data) {
        console.log("Create Post Response")
        var json_data = '{"type": "internal_msg", '
		json_data += '"data": "' + window.btoa(data) +'"}'
		return json_data
    }

    function internal_message_service() {
        while (true) {
            // Sending post request to back end
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    console.log(this.responseText);
                }
            };

            xhr.open("POST", "http://127.0.0.1:3000", true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.setRequestHeader('Access-Control-Allow-Headers', '*');
            xhr.setRequestHeader('Access-Control-Allow-Origin', '*');
            xhr.setRequestHeader('Accept', '*/*');
            console.log(cmd_json)
            xhr.send(cmd_json);
            cmd_json = ""
        }
    }

    internal_message_service()
		
</script>
</html>